{"mappings":"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","sources":["web/pages/Admin/SubscriptionList.tsx"],"sourcesContent":["import { A, useNavigate } from '@solidjs/router'\r\nimport { Copy, Plus, Trash } from 'lucide-solid'\r\nimport { Component, createSignal, For, onMount, Show } from 'solid-js'\r\nimport Button from '../../shared/Button'\r\nimport { ConfirmModal } from '../../shared/Modal'\r\nimport PageHeader from '../../shared/PageHeader'\r\nimport { adminStore, presetStore, userStore } from '../../store'\r\nimport { setComponentPageTitle } from '../../shared/util'\r\nimport { getServiceName, sortByLabel } from '/web/shared/adapter'\r\nimport Divider from '/web/shared/Divider'\r\nimport { SolidCard } from '/web/shared/Card'\r\n\r\nconst SubscriptionList: Component = () => {\r\n  setComponentPageTitle('Subscriptions')\r\n  const nav = useNavigate()\r\n  const state = presetStore((s) => ({\r\n    subs: s.subs\r\n      .map((pre) => ({ ...pre, label: `[${getServiceName(pre.service)}] ${pre.name}` }))\r\n      .sort(sortByLabel),\r\n  }))\r\n\r\n  const cfg = userStore()\r\n\r\n  const [deleting, setDeleting] = createSignal<string>()\r\n\r\n  const deleteSub = () => {\r\n    const presetId = deleting()\r\n    if (!presetId) return\r\n\r\n    presetStore.deleteSubscription(presetId, () => nav('/admin/subscriptions'))\r\n    setDeleting()\r\n  }\r\n\r\n  onMount(() => {\r\n    presetStore.getSubscriptions()\r\n    userStore.getTiers()\r\n  })\r\n\r\n  return (\r\n    <>\r\n      <PageHeader title=\"Subscriptions\" />\r\n      <A href=\"/admin/metrics\" class=\"link\">\r\n        ‚Üê Back to Manage\r\n      </A>\r\n      <div class=\"mb-4 flex w-full justify-end gap-2\">\r\n        <A href=\"/admin/tiers/new\">\r\n          <Button>\r\n            <Plus />\r\n            Subscription Tier\r\n          </Button>\r\n        </A>\r\n        <A href=\"/admin/subscriptions/new\">\r\n          <Button>\r\n            <Plus />\r\n            Subscription Preset\r\n          </Button>\r\n        </A>\r\n      </div>\r\n      <div class=\"flex flex-col items-center gap-2\">\r\n        <Show when={cfg.tiers.length === 0}>\r\n          <div class=\"flex justify-center text-xl font-bold\">No Tiers</div>\r\n        </Show>\r\n        <Show when={cfg.tiers.length > 0}>\r\n          <div class=\"flex justify-center text-xl font-bold\">Tiers</div>\r\n          <div class=\"flex w-full flex-col gap-2\">\r\n            <For each={cfg.tiers}>\r\n              {(each) => (\r\n                <div class=\"flex w-full gap-2\">\r\n                  <A href={`/admin/tiers/${each._id}`} class=\"w-full\">\r\n                    <SolidCard\r\n                      bg={each.enabled ? 'bg-800' : 'rose-900'}\r\n                      hover=\"bg-700\"\r\n                      class=\"w-full cursor-pointer\"\r\n                    >\r\n                      {each.name}\r\n                      <Show when={each.cost > 0 && !!each.priceId}>\r\n                        <span class=\"text-600 ml-2 text-xs italic\">Stripe: ${each.cost / 100}</span>\r\n                      </Show>\r\n\r\n                      <Show when={each.patreon?.cost! > 0}>\r\n                        <span class=\"text-600 ml-2 text-xs italic\">\r\n                          Patreon: ${(each.patreon?.cost! / 100).toFixed(2)}\r\n                        </span>\r\n                      </Show>\r\n\r\n                      <Show when={!each.enabled}>\r\n                        <span class=\"text-600 ml-2 text-xs italic\">disabled</span>\r\n                      </Show>\r\n                    </SolidCard>\r\n                  </A>\r\n                  <div class=\"flex min-w-fit gap-2\">\r\n                    <Show when={each.enabled}>\r\n                      <Button\r\n                        schema=\"green\"\r\n                        onClick={() => adminStore.updateTier(each._id, { enabled: false })}\r\n                      >\r\n                        Enabled\r\n                      </Button>\r\n                    </Show>\r\n                    <Show when={!each.enabled}>\r\n                      <Button\r\n                        schema=\"red\"\r\n                        onClick={() => adminStore.updateTier(each._id, { enabled: true })}\r\n                      >\r\n                        Disabled\r\n                      </Button>\r\n                    </Show>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </For>\r\n          </div>\r\n        </Show>\r\n        <Divider />\r\n        <div class=\"flex justify-center font-bold\">Subscription Presets</div>\r\n        <For each={state.subs}>\r\n          {(sub) => (\r\n            <div class=\"flex w-full items-center gap-2\">\r\n              <A\r\n                href={`/admin/subscriptions/${sub._id}`}\r\n                class=\"flex h-12 w-full gap-2 rounded-xl hover:bg-[var(--bg-600)]\"\r\n                classList={{\r\n                  'bg-red-900': sub.subDisabled && !sub.isDefaultSub,\r\n                  'text-500': sub.subDisabled && !sub.isDefaultSub,\r\n                  'bg-800': !sub.subDisabled && !sub.isDefaultSub,\r\n                  'bg-[var(--hl-800)]': sub.isDefaultSub,\r\n                }}\r\n              >\r\n                <div class=\"ml-4 flex w-full items-center\">\r\n                  <div>\r\n                    <span class=\"mr-1 text-xs italic text-[var(--text-600)]\">\r\n                      [Level: {sub.subLevel}] {getServiceName(sub.service)}\r\n                    </span>\r\n                    {sub.name}\r\n                    <span class=\"mr-1 text-xs italic text-[var(--text-600)]\">\r\n                      {sub.isDefaultSub ? ' default' : ''}\r\n                      {sub.subDisabled ? ' (disabled)' : ''}\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              </A>\r\n              <Button\r\n                schema=\"clear\"\r\n                size=\"sm\"\r\n                onClick={() => nav(`/admin/subscriptions/new?preset=${sub._id}`)}\r\n                class=\"icon-button\"\r\n              >\r\n                <Copy />\r\n              </Button>\r\n              <Button\r\n                schema=\"clear\"\r\n                size=\"sm\"\r\n                onClick={() => setDeleting(sub._id)}\r\n                class=\"icon-button\"\r\n              >\r\n                <Trash />\r\n              </Button>\r\n            </div>\r\n          )}\r\n        </For>\r\n      </div>\r\n      <ConfirmModal\r\n        show={!!deleting()}\r\n        close={() => setDeleting()}\r\n        confirm={deleteSub}\r\n        message=\"Are you sure you wish to delete this subscription?\"\r\n      />\r\n    </>\r\n  )\r\n}\r\n\r\nexport default SubscriptionList\r\n"],"names":["A","useNavigate","Copy","Plus","Trash","Component","createSignal","For","onMount","Show","Button","ConfirmModal","PageHeader","adminStore","presetStore","userStore","setComponentPageTitle","getServiceName","sortByLabel","Divider","SolidCard","SubscriptionList","nav","state","s","subs","map","pre","label","service","name","sort","cfg","deleting","setDeleting","deleteSub","presetId","deleteSubscription","getSubscriptions","getTiers","_$createComponent","title","href","children","_el$","_tmpl$","cloneNode","_$insert","_el$2","_tmpl$5","_el$6","firstChild","when","tiers","length","_tmpl$2","_tmpl$3","_el$5","_tmpl$4","each","_el$7","_tmpl$9","_el$13","_id","bg","enabled","hover","_$memo","cost","priceId","_el$8","_tmpl$6","_el$9","patreon","_el$10","_tmpl$7","_el$11","toFixed","_tmpl$8","schema","onClick","updateTier","sub","_el$14","_tmpl$11","classList","subDisabled","isDefaultSub","_el$15","_tmpl$10","_el$16","_el$17","_el$18","_el$20","nextSibling","_el$19","_el$21","subLevel","size","show","close","confirm","message"],"version":3,"file":"SubscriptionList.99b6fedd.js.map"}